<div class="upload-fotos-container">
    <header class="page-header">
        <h1>Upload de Fotos</h1>
        <p class="subtitle">Envie m√∫ltiplas fotos para a galeria</p>
    </header>

    <div *ngIf="erro" class="alert alert-danger">{{ erro }}</div>
    <div *ngIf="sucesso" class="alert alert-success">{{ sucesso }}</div>

    <div class="upload-form">
        <!-- Drag & Drop Zone -->
        <div class="drag-drop-zone" [class.dragging]="isDragging" (dragover)="onDragOver($event)"
            (dragleave)="onDragLeave($event)" (drop)="onDrop($event)">
            <div class="drag-drop-content">
                <span class="drag-icon">üì§</span>
                <h3>Arraste fotos aqui</h3>
                <p>ou</p>
                <input type="file" multiple accept="image/*" (change)="onFilesSelected($event)" class="file-input"
                    id="fotos">
                <label for="fotos" class="file-label-inline">
                    <span class="icon">üìÅ</span>
                    Clique para selecionar
                </label>
                <p class="help-text">At√© 20 imagens (JPG, PNG, GIF, WebP)</p>
            </div>
        </div>

        <div *ngIf="previews.length > 0" class="previews-section">
            <h3 class="section-title">Fotos Selecionadas ({{ previews.length }})</h3>
            <div class="previews-grid">
                <div *ngFor="let preview of previews; let i = index" class="preview-card">
                    <div class="preview-image">
                        <img [src]="preview.url" alt="Preview">
                        <button (click)="removerFoto(i)" class="btn-remove" title="Remover foto">‚úï</button>
                    </div>

                    <div class="preview-info">
                        <div class="form-group-compact">
                            <label [for]="'desc-' + i" class="form-label-small">Descri√ß√£o</label>
                            <textarea [id]="'desc-' + i" [(ngModel)]="preview.descricao" class="form-control-small"
                                rows="2" placeholder="Descreva esta foto..."></textarea>
                        </div>

                        <div class="form-group-compact">
                            <label class="form-label-small">Animais nesta foto</label>
                            <div class="animais-chips">
                                <div *ngFor="let animal of animais" class="animal-chip"
                                    [class.selected]="isAnimalSelecionado(i, animal._id)"
                                    (click)="onAnimalToggle(i, animal._id)">
                                    {{ animal.nome }}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div *ngIf="previews.length === 0" class="empty-state">
            <p class="icon">üì∏</p>
            <p>Nenhuma foto selecionada ainda</p>
        </div>

        <div class="form-actions">
            <button type="button" routerLink="/adm/fotos/lista" class="btn btn-secondary" [disabled]="carregando">
                Cancelar
            </button>
            <button (click)="uploadFotos()" class="btn btn-primary"
                [disabled]="carregando || fotosSelecionadas.length === 0">
                <span *ngIf="!carregando">üì§ Enviar Fotos</span>
                <span *ngIf="carregando">Enviando...</span>
            </button>
        </div>
    </div>
</div>