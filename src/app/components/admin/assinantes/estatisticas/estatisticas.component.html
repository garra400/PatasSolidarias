<div class="estatisticas-container">
    <div class="header">
        <div class="titulo-secao">
            <div class="icone-titulo">üìä</div>
            <div>
                <h1>Estat√≠sticas de Apoiadores</h1>
                <p class="subtitulo">Acompanhe m√©tricas e tend√™ncias dos apoiadores</p>
            </div>
        </div>
    </div>

    <!-- Loading -->
    @if (carregando) {
    <div class="loading-state">
        <div class="spinner"></div>
        <p>Carregando estat√≠sticas...</p>
    </div>
    }

    <!-- Erro -->
    @if (erro && !carregando) {
    <div class="erro-state">
        <span class="erro-icon">‚ö†Ô∏è</span>
        <p>{{ erro }}</p>
        <button class="btn-retry" (click)="carregarEstatisticas()">Tentar Novamente</button>
    </div>
    }

    <!-- Conte√∫do -->
    @if (!carregando && !erro) {
    <div class="estatisticas-content">
        <!-- Cards de M√©tricas Principais -->
        <div class="metricas-grid">
            <div class="metrica-card total">
                <div class="metrica-icon">üë•</div>
                <div class="metrica-info">
                    <span class="metrica-label">Total de Apoiadores</span>
                    <span class="metrica-valor">{{ stats.totalApoiadores }}</span>
                    <span class="metrica-subtitulo">Cadastrados no sistema</span>
                </div>
            </div>

            <div class="metrica-card ativos">
                <div class="metrica-icon">‚úÖ</div>
                <div class="metrica-info">
                    <span class="metrica-label">Apoiadores Ativos</span>
                    <span class="metrica-valor">{{ stats.apoiadoresAtivos }}</span>
                    <span class="metrica-subtitulo">Com contribui√ß√£o ativa</span>
                </div>
            </div>

            <div class="metrica-card arrecadacao">
                <div class="metrica-icon">üí∞</div>
                <div class="metrica-info">
                    <span class="metrica-label">Total Arrecadado</span>
                    <span class="metrica-valor">{{ stats.totalArrecadado | currency:'BRL' }}</span>
                    <span class="metrica-subtitulo">Valor acumulado</span>
                </div>
            </div>

            <div class="metrica-card media">
                <div class="metrica-icon">üìà</div>
                <div class="metrica-info">
                    <span class="metrica-label">M√©dia por Apoiador</span>
                    <span class="metrica-valor">{{ stats.valorMedioPorApoiador | currency:'BRL' }}</span>
                    <span class="metrica-subtitulo">Contribui√ß√£o m√©dia</span>
                </div>
            </div>
        </div>

        <!-- M√©tricas Secund√°rias -->
        <div class="metricas-secundarias">
            <div class="metrica-secundaria">
                <div class="metrica-sec-icon">‚è±Ô∏è</div>
                <div class="metrica-sec-info">
                    <span class="metrica-sec-label">Tempo M√©dio de Apoio</span>
                    <span class="metrica-sec-valor">{{ formatarMeses(stats.tempoMedioApoio) }}</span>
                </div>
            </div>

            <div class="metrica-secundaria">
                <div class="metrica-sec-icon">üéØ</div>
                <div class="metrica-sec-info">
                    <span class="metrica-sec-label">Taxa de Reten√ß√£o</span>
                    <span class="metrica-sec-valor">{{ stats.taxaRetencao }}%</span>
                </div>
            </div>

            <div class="metrica-secundaria">
                <div class="metrica-sec-icon">üíµ</div>
                <div class="metrica-sec-info">
                    <span class="metrica-sec-label">Arrecada√ß√£o Mensal M√©dia</span>
                    <span class="metrica-sec-valor">{{ stats.valorMedioMensal | currency:'BRL' }}</span>
                </div>
            </div>
        </div>

        <!-- Gr√°fico de Evolu√ß√£o Mensal -->
        <div class="grafico-card">
            <div class="grafico-header">
                <h2>üìà Evolu√ß√£o Mensal</h2>
                <p class="grafico-descricao">Acompanhe o crescimento e movimenta√ß√£o de apoiadores ao longo dos meses</p>
            </div>
            <div class="grafico-container">
                <canvas baseChart [data]="evolucaoMensalChartData" [options]="evolucaoMensalChartOptions"
                    [type]="evolucaoMensalChartType">
                </canvas>
            </div>
        </div>

        <!-- Gr√°fico de Apoiadores por Dia da Semana -->
        <div class="grafico-card">
            <div class="grafico-header">
                <h2>üìÖ Apoiadores por Dia da Semana</h2>
                <p class="grafico-descricao">Distribui√ß√£o de apoiadores por dia da semana em que come√ßaram a contribuir
                </p>
            </div>
            <div class="grafico-container">
                <canvas baseChart [data]="apoiadoresPorDiaChartData" [options]="apoiadoresPorDiaChartOptions"
                    [type]="apoiadoresPorDiaChartType">
                </canvas>
            </div>
        </div>

        <!-- Insights -->
        <div class="insights-card">
            <h2>üí° Insights</h2>
            <div class="insights-grid">
                <div class="insight-item">
                    <span class="insight-icon">üéØ</span>
                    <div class="insight-content">
                        <strong>Engajamento</strong>
                        <p>{{ ((stats.apoiadoresAtivos / stats.totalApoiadores) * 100).toFixed(1) }}% dos apoiadores
                            est√£o ativos</p>
                    </div>
                </div>
                <div class="insight-item">
                    <span class="insight-icon">‚≠ê</span>
                    <div class="insight-content">
                        <strong>Fidelidade</strong>
                        <p>Tempo m√©dio de apoio de {{ formatarMeses(stats.tempoMedioApoio) }}</p>
                    </div>
                </div>
                <div class="insight-item">
                    <span class="insight-icon">üíö</span>
                    <div class="insight-content">
                        <strong>Reten√ß√£o</strong>
                        <p>Taxa de reten√ß√£o de {{ stats.taxaRetencao }}% indica boa satisfa√ß√£o</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    }
</div>